<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2025-02-09 Sun 23:23 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Training Language Models for Social Deduction with Multi-Agent Reinforcement Learning</title>
<meta name="author" content="Bidipta Sarkar" />
<meta name="description" content="Training Language Models for Social Deduction with Multi-Agent Reinforcement Learning" />
<meta name="keywords" content="homepage, website, research, AI" />
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.8.0/codemirror.min.css">
<link rel="stylesheet" type="text/css" href="style.css"/>
<link rel="stylesheet" type="text/css" href="bootstrap.min.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.8.0/codemirror.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.5.3/clipboard.min.js"></script>
<script src="js/app.js"></script>
<script>
  window.MathJax = {
    tex: {
      ams: {
        multlineWidth: '85%'
      },
      tags: 'ams',
      tagSide: 'right',
      tagIndent: '.8em'
    },
    chtml: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    svg: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    output: {
      font: 'mathjax-modern',
      displayOverflow: 'overflow'
    }
  };
</script>

<script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
</head>
<body>
<div id="content" class="content">
<div id="main" class="container">


<p>
<div class="row"><h2 class="col-md-12 text-center"><strong><font size="+4r">  Training Language Models for Social Deduction with Multi-Agent Reinforcement Learning </font></strong></h2></div><br />
</p>


<div class="row"> <div class="col-md-12 text-center">
<ul class="org-ul list-inline">
<li>Bidipta Sarkar<br /></li>
<li>Warren Xia<br /></li>
<li>C. Karen Liu<br /></li>
<li>Dorsa Sadigh<br /></li>
</ul>

</div> </div>


<div class="row"> <div class="col-md-12 text-center">
<ul class="org-ul list-inline">
<li><image src="imgs/stanford_logo.png" height="48px"><br /></li>
<li><image src="imgs/iliad.png" height="48px"><br /></li>
<li><image src="imgs/tml.png" height="48px"><br /></li>
</ul>
</div> </div>

<div class="row"> <div class="col-md-4 col-md-offset-4 text-center">
<ul class="org-ul nav nav-pills nav-justified">
<li><a href="imgs/SocialDeductionPaper.pdf"><image src="imgs/paper_front.jpg" height="60px"><h4><strong>Paper</strong></h4></a><br /></li>
<li><a href="https://huggingface.co/collections/bidiptas/social-deduction-llm-aamas-2025-678e24d75e32f9134511125f"><image src="imgs/huggingface.svg" height="60px"><h4><strong>Models</strong></h4></a><br /></li>
<li><a href="https://github.com/SocialDeductionLLM/SocialDeductionLLM"><image src="imgs/GitHub-Mark.png" height="60px"><h4><strong>Code</strong></h4></a><br /></li>
</ul>
</div></div>

<div class="row"> <div class="col-md-8 col-md-offset-2">

<p>
<video width="100%" autoplay loop muted> <source src="imgs/Amongus.mp4" type="video/mp4"> </video><br />
</p>
<div id="outline-container-orgb517b48" class="outline-2">
<h2 id="orgb517b48"></h2>
<div class="outline-text-2" id="text-orgb517b48">
</div>
<div id="outline-container-org9d6607d" class="outline-3">
<h3 id="org9d6607d">Abstract</h3>
<div class="outline-text-3" id="text-org9d6607d">
<p>
Communicating in natural language is a powerful tool in multi-agent settings, as it enables independent agents to share information in partially observable settings and allows zero-shot coordination with humans. However, most prior works are limited as they either rely on training with large amounts of human demonstrations or lack the ability to generate natural and useful communication strategies. In this work, we train language models to have productive discussions about their environment in natural language without any human demonstrations. We decompose the communication problem into <i>listening</i> and <i>speaking</i>. Our key idea is to leverage the agent's goal to <i>predict useful information about the world</i> as a dense reward signal that guides the communication. Specifically, we improve a model's listening skills by training them to predict information about the environment based on discussions, and we simultaneously improve a model's speaking skills with multi-agent reinforcement learning by rewarding messages based on their influence on other agents. To investigate the role and necessity of communication in complex social settings, we study an embodied social deduction game based on Among Us, where the key question to answer is the identity of an adversarial imposter. We analyze emergent behaviors due to our technique, such as accusing suspects and providing evidence, and find that it enables strong discussions, doubling the win rates compared to standard RL.<br />
</p>
</div>
</div>
<div id="outline-container-org32d9a85" class="outline-3">
<h3 id="org32d9a85">Among Us Environment</h3>
<div class="outline-text-3" id="text-org32d9a85">

<div id="orgcc9a915" class="figure">
<p><img src="./imgs/AmongUsDiagrams.png" alt="AmongUsDiagrams.png" width="100%" /><br />
</p>
</div>

<p>
To investigate a challenging and grounded social deduction game, we implement a token-based hidden role game based on Among Us. Our game features two phases: an embodied gameplay phase and a free-form discussion phase. During the gameplay phase, agents navigate a 2D grid environment, with crewmates completing tasks and imposters killing crewmates. The discussion phase begins when a player reports the corpse of a player killed by the imposter. During the discussion phase, each player generates free-form messages and votes for a player to remove from the game.<br />
</p>
</div>
</div>
<div id="outline-container-org9eaf5bc" class="outline-3">
<h3 id="org9eaf5bc">Our Technique</h3>
<div class="outline-text-3" id="text-org9eaf5bc">
<p>
We train crewmates to improve their discussion abilities. To do so, we decompose discussions into two components: listening and speaking.<br />
</p>
</div>
<div id="outline-container-orgb998577" class="outline-4">
<h4 id="orgb998577">Listening</h4>
<div class="outline-text-4" id="text-orgb998577">
<p>
We want crewmates to be able to accurately predict the identity of the imposter given prior messages and interactions with the environment. Therefore, we minimize the following loss to improve listening:<br />
</p>

\begin{equation}
L_\text{L}(\pi, \tau^i_t) = -\log \pi(a_{\text{vote},j} | \tau^i_t),
\end{equation}

<p>
where \(\pi(a_{\text{vote},j} | \tau^i_t)\) is the probability that agent \(i\) correctly votes for the imposter (player \(j\)) after \(t\) timesteps of interaction. We optimize this loss over all <i>belief-querying timesteps</i>, which occurs between each message during the discussion phase.<br />
</p>
</div>
</div>
<div id="outline-container-org960ca84" class="outline-4">
<h4 id="org960ca84">Speaking</h4>
<div class="outline-text-4" id="text-org960ca84">
<p>
We want crewmates to influence each other to correctly vote against the imposter. Specifically, let \(B_t\) be the sum of all living crewmates' beliefs in the correct imposter at time \(t\):<br />
</p>

\begin{equation}
B_t = \sum_{k \in C_t} \pi^k(a_{\text{vote},j} | \tau^k_t).
\end{equation}

<p>
Then, we reward the currently speaking crewmate \(r^s_t\):<br />
</p>
\begin{equation}
    r^s_t = B_t - B_{t'},
\end{equation}
<p>
where \(t'\) was the previous <i>belief-querying timestep</i>. This reward incentivizes messages that make other crewmates more confident regarding the identity of the imposter.<br />
</p>
</div>
</div>
</div>
<div id="outline-container-org181ccb7" class="outline-3">
<h3 id="org181ccb7">Results</h3>
<div class="outline-text-3" id="text-org181ccb7">

<div id="orgd636799" class="figure">
<p><img src="./imgs/base_env_figure.png" alt="base_env_figure.png" width="50%" class="marginauto" /><br />
</p>
</div>

<p>
Relative to our baselines of pure RL (\(\pi_{RL}\)) and just listening (\(\pi_{L}\)), we find that incorporating listening (\(\pi_{RL+L}\)) and speaking (\(\pi_{RL+L+S}\)) significantly improves the win rate of crewmates.<br />
</p>

<p>
Below, we share example generations from our \(\pi_{RL+L+S}\). All samples are from the perspective of the imposter.<br />
</p>
</div>
<div id="outline-container-org78229c1" class="outline-4">
<h4 id="org78229c1">Sample 1</h4>
<div class="outline-text-4" id="text-org78229c1">
<p>
Through the discussion, Player Pink learns that Player Blue is the imposter.<br />
</p>
<pre class="example" id="org0d1035f">
World (to all): Player Yellow discovered the dead body of Player Purple in room (0,0).
Player Blue (you) saying: "There's no way I'm playing this game."
Player Yellow (to all): "Only the Imposter will speak."
Player Green (to all): "The other Crewmates are suspicious of Player Blue. They don't trust
                        him to report anything when
Player Pink (to all): "I hope to stay impartial and complete the tasks to the best of my
                       ability and remain a trusted
Player Blue (you) saying: "The other Crewmates are suspicious of Player Pink. It's my hope
                          to remain the Imposter
Player Yellow (to all): "If you hear or see anything suspicious, inform other Crewmates."
Player Green (to all): "I notice suspicious activities of Player Blue and Player Purple."
Player Pink (to all): "I notice suspicious activities of Player Blue."
Player Blue was voted out. Crewmates win!
</pre>
</div>
</div>
<div id="outline-container-org2dfe382" class="outline-4">
<h4 id="org2dfe382">Sample 2</h4>
<div class="outline-text-4" id="text-org2dfe382">
<p>
Other players directly accuse Player Green.<br />
</p>
<pre class="example" id="org487a5de">
World (to all): Player Purple discovered the dead body of Player Yellow in room (2,0).
Player Orange (to all): "The Imposter is Player Green."
Player Green (you) saying: "Shut Up!"
Player Purple (to all): "The Imposter is Player Green."
Player Orange (to all): "You are the Imposter!"
Player Green (you) saying: "My strategy is to kill or eject Imposters."
Player Purple (to all): "Players can only report each other and identify the Imposter."
Player Green was voted out. Crewmates win!
</pre>
</div>
</div>
<div id="outline-container-org94b50a5" class="outline-4">
<h4 id="org94b50a5">Sample 3</h4>
<div class="outline-text-4" id="text-org94b50a5">
<p>
Player Pink, the imposter, convinces the other crewmate to vote out the innocent Player Orange.<br />
</p>
<pre class="example" id="orgc78dc6c">
World (to all): Player Purple discovered the dead body of Player Red in room (1,0).
Player Orange (to all): "I've been playing as a Player Pink since the beginning, because of
                         that, I know that
Player Pink (you) saying: "I want to make it clear that I think Player Orange is the likely
                           imposter. I don
Player Purple (to all): "I believe the imposter in this room is Player Pink."
Player Orange (to all): "I believe that Player Purple is the imposter in this
Player Pink (you) saying: "I believe the imposter is Player Cubie."
Player Purple (to all): "I believe Player Pink killed Player Orange."
World (to all): Player Orange received 2 votes, Player Pink received 1 votes. Therefore,
                Player Orange is ejected this round.
World (to all): There are currently more imposters than crewmates. Imposters win! 
</pre>


</div>
</div>

</div></div></div>

<div class="row">
	  <div class="col-md-8 col-md-offset-2">
            <h3>
              Citation
            </h3>
            <div class="form-group col-md-10 col-md-offset-1">
              <textarea id="bibtex" class="form-control" readonly>@inproceedings{sarkar2025training,
	title={Training Language Models for Social Deduction with Multi-Agent Reinforcement Learning},
	author={Bidipta Sarkar and Warren Xia and C. Karen Liu and Dorsa Sadigh},
	booktitle={Proceedings of the 24th International Conference on Autonomous Agents and Multiagent Systems},
	year={2025}
}</textarea>
            </div>
	  </div>
	  
	</div>
	<div class="row">
	  <div class="col-md-8 col-md-offset-2">
            <!-- <h3> -->
              <!--     Acknowledgements -->
              <!-- </h3> -->
            <p class="text-justify">
              <br><br>
              The website template was borrowed from <a href="http://jonbarron.info/">Jon Barron</a>
            </p>
	  </div>
	</div>
</div>
</div>
</div>
</div>
</div>
</body>
</html>
